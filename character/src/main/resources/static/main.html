<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>COC人物车卡</title>
    <link rel="stylesheet" type="text/css" href="layui/css/layui.css">

    <script type="text/javascript" src="layui/layui.js"></script>
</head>
<body>
<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
    <legend>创建人物</legend>
</fieldset>


<form action="" id="form1">
    <div class="layui-form-item">
        <label class="layui-form-label">探员编号</label>
        <div class="layui-input-block">
            <input type="number" name="userid"	id="userid" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">探员姓名</label>
        <div class="layui-input-block">
            <input type="text" name="name"	id="name" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">探员年龄</label>
        <div class="layui-input-block">
            <input type="number" name="age"	id="age" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">国籍</label>
        <div class="layui-input-block">
            <input type="text" name="nationality"	id="nationality" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">居住地</label>
        <div class="layui-input-block">
            <input type="text" name="birthplace"	id="birthplace" class="layui-input">
        </div>
    </div>



    <div class="layui-form-item">
        <label class="layui-form-label">探员性别</label>
        <div class="layui-input-block">
            <select name="sex"  id="sex" size="1">
                    <option value="0">男</option>
                    <option value="1">女</option>
                    <option value="2" selected="">其他</option>

            </select>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">探员职业</label>
        <div class="layui-input-block">
            <select name="profession"  id="profession" size="1">
                <option value="0">工农阶级</option>
                <option value="1">无产阶级</option>
                <option value="2" selected="">军人阶级</option>
                <option value="3">资本家阶级</option>
                <option value="4">科技工作者</option>
                <option value="5">其他</option>

            </select>
        </div>
    </div>



    <button id="btn" class="layui-btn layui-btn-normal" type="button">确认</button>

</form>
<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
    <legend>探员小卡片</legend>
</fieldset>



<div>
    <h3><fieldset class="layui-elem-field layui-field-title" style="margin-top: 15px;color: #FF5722">个人信息</fieldset></h3>
</div>
<table id="tb1" class="layui-table">
    <thead id="thead1">
    <tr>
        <th>姓名</th>
        <th>年龄</th>
        <th>性别</th>
        <th>性向</th>
        <th>职业</th>
        <th>国籍</th>
        <th>现居地</th>
        <th>专业点</th>
        <th>兴趣点</th>
    </tr>
    </thead>
    <tbody id="tbody1">

    </tbody>
</table>
<div>
    <h3><fieldset class="layui-elem-field layui-field-title" style="margin-top: 15px;color: #FF5722">属性值</fieldset></h3>
</div>
<table id="tb2" class="layui-table">
    <thead id="thead2">
    <tr>
        <th>力量</th>
        <th>敏捷</th>
        <th>教育</th>
        <th>体质</th>
        <th>魅力</th>
        <th>意志</th>
        <th>体型</th>
        <th>智力/灵感</th>
        <th>幸运</th>
        <th>CueerentHP/HP</th>
        <th>CueerentMP/MP</th>
        <th>CueerentSAN/SAN</th>
    </tr>
    </thead>
    <tbody id="tbody2">

    </tbody>
</table>
<div>
    <h3><fieldset class="layui-elem-field layui-field-title" style="margin-top: 15px;color: #FF5722">技能值（+）</fieldset></h3>
</div>
<table id="tb3" class="layui-table">
    <thead id="thead3">
    <tr>
        <th>技能名</th>
        <th>技能等级</th>
        <th>技能名</th>
        <th>技能等级</th>
        <th>技能名</th>
        <th>技能等级</th>
        <th>技能名</th>
        <th>技能等级</th>
    </tr>
    </thead>
    <tbody id="tbody3">

    </tbody>
</table>

<div>
    <h3><fieldset class="layui-elem-field layui-field-title" style="margin-top: 15px;color: #FF5722">个人介绍</fieldset></h3>
</div>
<table id="tb4" class="layui-table">
    <thead id="thead4">
    <tr>
        <th>武器装备</th>
        <th>克苏鲁见识</th>
        <th>重要人物</th>
        <th>害怕/狂热</th>
        <th>背景故事</th>
    </tr>
    </thead>
    <tbody id="tbody4">

    </tbody>
</table>

</body>
<script src="js/jquery-3.3.1.min.js"></script>
<script src="layer/2.4/layer.js"></script>
<script type="text/javascript" src="js/jquery.serializejson.min.js"></script>
<script >
    var userToken = window.localStorage.getItem("yq_token");

    $.ajax({

        headers: {

            "token":userToken//此处放置请求到的用户token

        },

        type: "get",

        url: "http://119.254.155.151:8768/yq/important/data?schemeId=247248",//请求url

        contentType: "application/x-www-form-urlencoded",

        success: (data) => {

        }

    })




    $(function(){

        $("#btn").on('click',function(e){
            var obj=$('#form1').serializeJSON();//将表单中元素转换为JSON对象
            var pstr=JSON.stringify(obj);//JSON字符串
            console.log("字符串"+pstr)
            $.ajax({
                method:'post',
                url:'/user/create',
                data:pstr,
                success:function(data){
                    alert(data)
                    if(data=='人物创建成功'){
                        query()
                        btn_disabled()
                    }




                },
                dataType:'text',
                contentType:'application/json',
                xhrFileds:{
                    withCredentials:true
                }
            });
        })

    });
    function query() {
        var obj=$('#form1').serializeJSON();//将表单中元素转换为JSON对象
        var pstr=JSON.stringify(obj);//JSON字符串
        console.log("字符串"+pstr)
        $.ajax({
            method:'post',
            url:'/register/person',
            data:pstr,
            success:function(data){
                var data= eval('(' + data + ')');

                var tr='';
                var tr1='';
                var tr2='';
                var tr3='';
                var tr4='';
                var tr5='';
                var tr6='';
                var tr7='';
                var tr8='';
                var tr9='';
                var tr10='';
                var tr11='';
                var tr12='';
                var tr13='';
                var tr14='';
                var tr15='';
                var tr16='';
                var tr17='';
                var tr18='';
                var tr19='';

                tr+=`
					<tr>
					<td>${data.name}</td>
					<td>${data.age}</td>
					<td>${data.sex}</td>
					<td>${data.sex}</td>
					<td>${data.profession}</td>
					<td>${data.nationality}</td>
					<td>${data.birthplace}</td>
					<td>${data.potential}</td>
					<td>${data.interest}</td>
					</tr>
					`
                tr1+=`
					<tr>
					<td>${data.str}</td>
					<td>${data.agl}</td>
					<td>${data.edu}</td>
					<td>${data.phy}</td>
					<td>${data.cha}</td>
					<td>${data.vol}</td>
					<td>${data.bod}</td>
					<td>${data.bra}</td>
					<td>${data.luck}</td>
					<td>${data.currenthp}/${data.hp}</td>
					<td>${data.currentmp}/${data.mp}</td>
					<td>${data.currentsan}/${data.san}</td>
					</tr>
					`
                tr2+=`
					<tr>

					<td>侦查</td>
					<td>${data.spy}</td>
					<td>聆听</td>
					<td>${data.listen}</td>
					<td>图书馆使用</td>
					<td>${data.libaray}</td>
					<td>克苏鲁</td>
					<td>${data.cthulhu}</td>
					</tr>

					`
                tr3+=`
<tr>
                    <td>魅惑</td>
					<td>${data.charm}</td>
					<td>恐吓</td>
					<td>${data.threaten}</td>
                    <td>说服</td>
					<td>${data.negotiate}</td>
					<td>话术</td>
					<td>${data.trick}</td>
					<tr>


					</tr>
					`
                tr4+=`
<tr>
                    <td>精神分析</td>
					<td>${data.psychiatrist}</td>
                    <td>心理学</td>
					<td>${data.psychology}</td>
                    <td>神秘学</td>
					<td>${data.occultism}</td>
					<td>博物学</td>
					<td>${data.naturalist}</td>
					<tr>
					</tr>
					`
                tr5+=`
<tr>
					<td>天文学</td>
					<td>${data.astronomy}</td>
					<td>植物学</td>
					<td>${data.phytology}</td>
					<td>人类学</td>
					<td>${data.anthropology}</td>
					<td>考古学</td>
					<td>${data.archeology}</td>
					</tr>
					`
                tr6+=`
					<tr>
					<td>密码学</td>
					<td>${data.cryptology}</td>
					<td>气象学</td>
					<td>${data.meteorology}</td>
					<td>地质学</td>
					<td>${data.geology}</td>
					<td>工程学</td>
					<td>${data.engineering}</td>
					</tr>
					`
                tr7+=`
                  <tr>
                    <td>动物学</td>
					<td>${data.zoology}</td>
	                <td>格斗（斗殴）</td>
					<td>${data.combat}</td>
					<td>格斗（刀剑）</td>
					<td>${data.sword}</td>
					<td>格斗（枪矛）</td>
					<td>${data.spear}</td>
					</tr>
					`
                tr8+=`
					<tr>
					<td>射击（手枪)</td>
					<td>${data.pistol}</td>
					<td>射击（步枪）</td>
					<td>${data.gun}</td>
					<td>射击(弓弩)</td>
					<td>${data.crossbow}</td>
					<td>炮术</td>
					<td>${data.gunnery}</td>

					</tr>
					`
                tr9+=`
					<tr>
					<td>潜水</td>
					<td>${data.diving}</td>
					<td>投掷</td>
					<td>${data.throwing}</td>
					<td>追踪</td>
					<td>${data.trace}</td>
					<td>闪避</td>
					<td>${data.dodge}</td>

					</tr>
					`
                tr10+=`
					<tr>
					<td>潜行</td>
					<td>${data.sneak}</td>
					<td>攀爬</td>
					<td>${data.shin} <button type="button" id="button_shin_up" class="layui-btn layui-btn-normal layui-btn-sm" ><i class="layui-icon  layui-icon-up">+5</i></button><button type="button" id="button_shin_down" class="layui-btn layui-btn-danger layui-btn-sm  "><i class="layui-icon layui-icon-down">-5</i></button></td>
					<td>游泳</td>
					<td>${data.swim}</td>
					<td>跳跃</td>
					<td>${data.jump}</td>
					</tr>
					`
                tr11+=`
					<tr>
					<td>急救</td>
					<td>${data.aid}</td>
					<td>医学</td>
					<td>${data.medical}</td>
					<td>驯兽</td>
					<td>${data.beasttraining}</td>
					<td>妙手</td>
					<td>${data.steal}</td>
					</tr>
					`
                tr12+=`
					<tr>
					<td>锁匠</td>
					<td>${data.locksmith}</td>
					<td>会计</td>
					<td>${data.accountant}</td>
					<td>历史</td>
					<td>${data.history}</td>
					<td>速记</td>
					<td>${data.shorthand}</td>
					</tr>
					`
                tr13+=`
					<tr>
					<td>伪造</td>
					<td>${data.falsify}</td>
					<td>读唇</td>
					<td>${data.lipread}</td>
					<td>重型器械驾驶</td>
					<td>${data.heavy}</td>
					<td>机械维修</td>
					<td>${data.mechanology}</td>
					</tr>
					`
                tr14+=`
					<tr>
					<td>电子学</td>
					<td>${data.electrical}</td>
					<td>电气维修</td>
					<td>${data.maintenance}</td>
					<td>厨艺</td>
					<td>${data.cooking}</td>
                    <td>领航</td>
					<td>${data.pilot}</td>

					</tr>
					`
                tr15+=`

					<tr>
					 <td>计算机使用</td>
					<td>${data.computer}</td>
					<td>法律</td>
					<td>${data.law}</td>
					 <td>生火</td>
					<td>${data.fire}</td>
					<td>耕作</td>
					<td>${data.farming}</td>



					</tr>
					`
                tr16+=`
					<tr>
					<td>性学</td>
					<td>${data.makesex}</td>
					<td>乐理</td>
					<td>${data.musictheory}</td>
					<td>估价</td>
					<td>${data.evaluate}</td>
					<td>乔装</td>
					<td>${data.dress}</td>
					</tr>
					`
                tr17+=`
					<tr>
					 <td>驾驶</td>
					<td>${data.drive}</td>
					<td>信用</td>
					<td>${data.credit}</td>
					<td>化学</td>
					<td>${data.chemistry}</td>
					<td>迷惑</td>
					<td>${data.puzzle}</td>

					</tr>
					`
                tr18+=`
					<tr>
					<td>外语</td>
					<td>${data.foreign}</td>
					<td>母语</td>
					<td>${data.mothertongue}</td>
					<td>自定义1</td>
					<td>${data.ohterone}</td>
					<td>自定义2</td>
					<td>${data.othertwo}</td>
					</tr>
					`
                tr19+=`
					<tr>
					<td>自定义3</td>
					<td>${data.otherthree}</td>
					<td>自定义4</td>
					<td>${data.otherfour}</td>
					<td>自定义5</td>
					<td>${data.otherfive}</td>
					<td>自定义6</td>
					<td>${data.othersix}</td>
					</tr>
					`
                $('#tbody1').append(tr);
                $('#tbody2').append(tr1);
                $('#tbody3').append(tr2);
                $('#tbody3').append(tr3);
                $('#tbody3').append(tr4);
                $('#tbody3').append(tr5);
                $('#tbody3').append(tr6);
                $('#tbody3').append(tr7);
                $('#tbody3').append(tr8);
                $('#tbody3').append(tr9);
                $('#tbody3').append(tr10);
                $('#tbody3').append(tr11);
                $('#tbody3').append(tr12);
                $('#tbody3').append(tr13);
                $('#tbody3').append(tr14);
                $('#tbody3').append(tr15);
                $('#tbody3').append(tr16);
                $('#tbody3').append(tr17);
                $('#tbody3').append(tr18);
                $('#tbody3').append(tr19);


            },
            dataType:'text',
            contentType:'application/json',
            xhrFileds:{
                withCredentials:true
            }
        });
    }
    function btn_disabled() {
    $(document).ready(function() {
        $("#btn").attr("disabled","true");
        $("#btn").css({'background-color' : 'gray'});

    });
    }


</script>

</body>
</html>